function dydt = cr3b_ode(t,yy)

mu = 3.0404326333266026076e-6;

x = yy(1,:);
y = yy(2,:);
z = yy(3,:);

r1sq = sqrt((mu+x).^2+y.^2+z.^2);
r1_32 = 1./(r1sq.^3);


r2sq = sqrt((-1+mu+x).^2+y.^2+z.^2);
r2_32 = 1./(r2sq.^3);

Ux=x+(-1).*mu.*((-1)+mu+x).*r2_32+(-1).*(1+(-1).*mu).*(mu+x).*r1_32;

Uy=y+(-1).*mu.*y.*r2_32+(-1).*(1+(-1).*mu).*y.*r1_32;

Uz=(-1).*mu.*z.*r2_32+(-1).*(1+(-1).*mu).*z.*r1_32;

dydt = [yy(4,:);
        yy(5,:);
        yy(6,:);
        +2*yy(5,:) + Ux;
        -2*yy(4,:) + Uy;
        Uz];
